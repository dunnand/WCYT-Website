<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Girls Basketball vs Opponent</title>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 900px; margin: auto; }
    h1 { margin-bottom: 0.5em; }
    label { display: block; margin-top: 1em; margin-bottom: 0.5em; }
    select { font-size: 1em; padding: 6px; width: 100%; max-width: 300px; }
    table { border-collapse: collapse; width: 100%; margin-top: 1em; }
    th, td { border: 1px solid #ccc; padding: 6px 8px; text-align: left; }
  </style>
</head>
<body>
  <h1>Girls Basketball: Game History by Opponent</h1>

  <label for="opp">Select Opponent</label>
  <select id="opp"><option value="">– All –</option></select>

  <div id="table_div"></div>

  <script>
    // —— CONFIGURE THESE TWO VALUES —— 
    // 1) Your published‑copy ID (the long 2PACX‑… string)
    const PUB_ID = '2PACX-1vTqEGHE6D3L5nhLHkb06xMPygzsEOI9fJBOctiXXhuV8j53xSsTN1qe7g8N0m6PDV7Q_kmjdoeX0j';
    // 2) The GID of your raw "Girls W/L Data Sheet" tab
    const DATA_GID = '2064027631';

    // Build the base URL for gviz queries
    const BASE_URL = `https://docs.google.com/spreadsheets/d/e/${PUB_ID}`;

    // Load Google Charts (Table package)
    google.charts.load('current', { packages:['table'] });
    google.charts.setOnLoadCallback(init);

    function init() {
      populateDropdown();
      document.getElementById('opp').addEventListener('change', drawTable);
    }

    // Query column C for all distinct opponents
    function populateDropdown() {
      const q = 'select distinct C order by C';
      const url = `${BASE_URL}/gviz/tq?gid=${DATA_GID}&tq=${encodeURIComponent(q)}`;

      new google.visualization.Query(url).send(res => {
        if (res.isError()) {
          console.error('Dropdown query error:', res.getMessage());
          return;
        }
        const dt = res.getDataTable();
        const sel = document.getElementById('opp');

        for (let i = 0; i < dt.getNumberOfRows(); i++) {
          const opp = dt.getValue(i, 0);
          if (opp) {
            const opt = document.createElement('option');
            opt.value = opp;
            opt.text  = opp;
            sel.appendChild(opt);
          }
        }
        // Draw full table on first load
        drawTable();
      });
    }

    // Re‑query the sheet, filtering where column C contains the selected opponent
    function drawTable() {
      const sel = document.getElementById('opp').value;
      let q = 'select A,B,C,D,E,F,G,H';
      if (sel) {
        // escape any single quotes in sel
        const safe = sel.replace(/'/g,"\\'");
        q += ` where C contains '${safe}'`;
      }
      const url = `${BASE_URL}/gviz/tq?gid=${DATA_GID}&tq=${encodeURIComponent(q)}`;

      new google.visualization.Query(url).send(res => {
        if (res.isError()) {
          console.error('Table query error:', res.getMessage());
          return;
        }
        const data  = res.getDataTable();
        const table = new google.visualization.Table(
          document.getElementById('table_div')
        );
        table.draw(data, { showRowNumber:false, width:'100%', height:'auto' });
      });
    }
  </script>
</body>
</html>



